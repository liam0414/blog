# COMP9417-Machine Learning & Data Mining - 2024 T2 Week 0

## Homework 0 solution

### Question 1. (Calculus Review)

#### Question (a)

Consider the function

$$ f(x, y) = a_1x^2y^2 + a_4xy + a_5x + a_7 $$

compute all first and second order partial derivatives of $f(x, y)$ with respect to $x$ and $y$.

- First order partial derivatives:

> $$ \frac{\partial f}{\partial x} = 2a_1xy^2 + a_4y + a_5 $$

> $$ \frac{\partial f}{\partial y} = 2a_1x^2y + a_4x $$

- Second order partial derivatives:

> $$ \frac{\partial^2 f}{\partial x^2} = 2a_1y^2 $$

> $$ \frac{\partial^2 f}{\partial y^2} = 2a_1x^2 $$

#### Question (b)

Consider the function

$$ f(x, y) = a_1x^2y^2 + a_2x^2y + a_3xy^2 + a_4xy + a_5x + a_6y + a_7 $$

compute all first and second order partial derivatives of $f(x, y)$ with respect to $x$ and $y$.

- First order partial derivatives:

> $$ \frac{\partial f}{\partial x} = 2a_1xy^2 + 2a_2xy + a_3y^2 + a_4y + a_5 $$

> $$ \frac{\partial f}{\partial y} = 2a_1x^2y + a_2x^2 + 2a_3xy + a_4x + a_6 $$

- Second order partial derivatives:

> $$ \frac{\partial^2 f}{\partial x^2} = 2a_1y^2 + 2a_2y $$

> $$ \frac{\partial^2 f}{\partial y^2} = 2a_1x^2 + 2a_3x $$

#### Question (c)

Consider the logistic sigmoid:

$$ \sigma(x) = \frac{1}{1 + e^{-x}} $$

show that the derivative of the logistic sigmoid is:

$$ \frac{d\sigma(x)}{dx} = \sigma(x)(1 - \sigma(x)) $$

- Derivative of the logistic sigmoid:

> $$ \frac{d\sigma(x)}{dx} = \frac{d}{dx} \left( \frac{1}{1 + e^{-x}} \right) $$

Use the chain rule, set $u = 1 + e^{-x}$, then

> $$ \frac{d\sigma(x)}{dx} = \frac{d}{du} \left( \frac{1}{u} \right) \cdot \frac{du}{dx} $$
> $$ = \frac{e^{-x}}{(1 + e^{-x})^2} $$
> $$ = \frac{1}{1 + e^{-x}} \cdot \frac{e^{-x}}{1 + e^{-x}} $$
> $$ = \sigma(x)(1 - \sigma(x)) $$

#### Question (d)

Consider the following functions:

- $$ y_1 = 4x^2 - 3x + 3 $$
- $$ y_2 = 3x^4 - 2x^3 $$
- $$ y_3 = 4x + \sqrt{1-x} $$
- $$ y_4 = x + x^{-1} $$

Using the second derivative test, find all local maximum and minimum points.

Second derivative test:

- The first derivative of $y_1$ is $8x - 3$, set it to 0, we get $x = \frac{3}{8}$.
  The second derivative of $y_1$ is 8, $y_1$ has a local minimum at $x = \frac{3}{8}$.
- The first derivative of $y_2$ is $12x^3 - 6x^2$, set it to 0, we get $x = 0$ and $x = \frac{1}{2}$.
  The second derivative of $y_2$ is $36x^2 - 12x$, $y_2''$ is 0 at $x = 0$, it is inflection point. $y_2''$ is positive at $x = \frac{1}{2}$, $y_2$ has a local minimum.
- The first derivative of $y_3 = 4 - \frac{1}{2\sqrt{1-x}}$, set it to 0, we get $x = \frac{63}{64}$.
  The second derivative of $y_3$ is $\frac{1}{4(1-x)^{3/2}}$, $y_3''$ is positive at $x = \frac{63}{64}$, $y_3$ has a local minimum.
- The first derivative of $y_4$ is $1 - x^{-2}$, set it to 0, we get $x = 1$ and $x = -1$.
  The second derivative of $y_4$ is $2x^{-3}$, $y_4''$ is positive at $x = 1$,
  $y_4$ has a local minimum. And $y_4''$ is negative at $x = -1$, $y_4$ has a local maximum.

### Question 2. (Probability Review)

#### Question (a)

A manufacturing company has two retail outlets. It is known that 20% of potential customers buy
products from Outlet I alone, 10% buy from both I and II, and 40% buy from neither. Let A denote
the event that a potential customer, randomly chosen, buys from outel I, and B the event that the
customer buys from outlet II. Compute the following probabilities:

- $$ P(A) = 0.2 + 0.1 = 0.3 $$
- $$ P(B) = 0.1 + 0.3 = 0.4 $$
- $$ P(A \cap B) = 0.1 $$
- $$ P(\overline{A} \cup \overline{B}) = 0.4 $$

#### Question (b)

Let X; Y be two discrete random variables, with joint probability mass function P(X = x; Y = y) displayed in the table below:

|         |     |               | $y$            |                |
| ------- | --- | ------------- | -------------- | -------------- |
|         |     | 1             | 2              | 3              |
|         | 1   | $\frac{1}{6}$ | $\frac{1}{12}$ | $\frac{1}{12}$ |
| **$x$** | 2   | $\frac{1}{6}$ | 0              | $\frac{1}{6}$  |
|         | 3   | 0             | r              | 0              |

Compute the following quantities:

- (i) r = 1/3 because the sum of the joint probability mass function is 1.
- (ii) $P(X = 2, Y = 3) = \frac{1}{6}$
- (iii) $P(X = 3) =  0 + r + 0 = 0 + \frac{1}{3} = \frac{1}{3}$, $P(X = 3|Y = 2)$ = $\frac{P(X = 3, Y = 2)}{P(Y = 2)} = \frac{\frac{1}{3}}{\frac{1}{12} + 0 + \frac{1}{3}} = \frac{4}{5}$
- (iv) To calculate E[X], E[Y], E[XY], we can use the formula:
  - $ E[X] = 1\cdot P(X = 1) + 2\cdot P(X = 2) + 3\cdot P(X = 3) = 1\cdot \frac{1}{3} + 2\cdot \frac{1}{3} + 3\cdot \frac{1}{3} = 2 $
  - $ E[Y] = 1\cdot P(Y = 1) + 2\cdot P(Y = 2) + 3\cdot P(Y = 3) = 1\cdot \frac{1}{3} + 2\cdot \frac{5}{12} + 3\cdot \frac{1}{4} = \frac{23}{12} = 1.9167 $
  - $ E[XY] = 1\cdot 1\cdot \frac{1}{6} + 1\cdot 2\cdot \frac{1}{12} + 1\cdot 3\cdot \frac{1}{12} + 2\cdot 1\cdot \frac{1}{6} + 2\cdot 3\cdot \frac{1}{6} + 3\cdot 2\cdot \frac{1}{3} = \frac{1}{6} + \frac{1}{6} + \frac{1}{4} + \frac{1}{3} + 1 + 2 = \frac{47}{12} = 3.9167 $
- (v) $E[X^2], E[Y^2]$:
  - $E[X^2] = 1^2\cdot P(X = 1) + 2^2\cdot P(X = 2) + 3^2\cdot P(X = 3) = 1\cdot \frac{1}{3} + 4\cdot \frac{1}{3} + 9\cdot \frac{1}{3} = \frac{14}{3} = 4.6667 $
  - $E[Y^2] = 1^2\cdot P(Y = 1) + 2^2\cdot P(Y = 2) + 3^2\cdot P(Y = 3) = 1\cdot \frac{1}{3} + 4\cdot \frac{5}{12} + 9\cdot \frac{1}{4} = \frac{17}{4} = 4.25 $
- (vi) $ Cov(X, Y ) = E[XY] - E[X]E[Y] = \frac{47}{12} - 2\cdot\frac{23}{12} = \frac{1}{12} = 0.0833 $
- (vii) $ Var(X) = E[X^2] - E[X]^2 = 4.6667 - 2^2 = 0.6667, Var(Y) = E[Y^2] - E[Y]^2 = 4.25 - (23/12)^2 = 0.5764 $
- (viii) $ Corr(X, Y ) = \frac{Cov(X, Y)}{\sqrt{Var(X)Var(Y)}} = \frac{0.0833}{\sqrt{0.6667\cdot 0.5764}} = 0.1343 $
- (ix) $E[X + Y ], E[X + Y^2], Var(X + Y ), Var(X + Y^2).$
  - $E[X + Y] = E[X] + E[Y] = 2 + 1.9167 = 3.9167$
  - $E[X + Y^2] = E[X] + E[Y^2] = 2 + 4.25 = 6.25$
  - $Var(X + Y) = Var(X) + Var(Y) + 2Cov(X, Y) = 0.6667 + 0.5764 + 2\cdot 0.0833 = 1.4097$
  - $Var(X + Y^2), too much work, skip$

### Question 3. (Linear Algebra Review)

#### Question (a)

Write down the dimensions of the following objects:

$$
A = \left[\begin{array}{cc} 1 & 3 & 1 & 0 & 2\\ 1 & 1 & 4 & 1 & 2\\ 1 & 1 & 1 & 5 & 2 \end{array}\right],
b = \left[\begin{array}{cc} 1 \\ 1 \\ 1 \\ 3 \\ 3 \\ 2 \end{array}\right],
A^T
$$

- $A$ is a $3 \times 5$ matrix, $b$ is a $5 \times 1$ matrix, $A^T$ is a $5 \times 3$ matrix.

#### Question (b)

Consider the following objects:

$$
A = \left[\begin{array}{cc} 1 & 3 & 4 \\ 2 & 2 & 1 \\ 6 & 4 & 3 \end{array}\right],
B = \left[\begin{array}{cc} 2 & 4 \\ 1 & 1 \end{array}\right],
C = \left[\begin{array}{cc} 7 & 3 & 3 \\ 2 & 1 & 1 \\ 2 & 2 & 2 \end{array}\right],
D = \left[\begin{array}{cc} 4 & 2 \\ 4 & 6 \\ 1 & 3 \end{array}\right],
u = \left[\begin{array}{cc} 1 \\ 3 \end{array}\right],
v = \left[\begin{array}{cc} 2 \\ 4 \\ 1 \end{array}\right]
$$

Compute the following:

- (i) AB and BA: Both are not defined because the number of columns of the first matrix does not match the number of rows of the second matrix.
- (ii) AC and CA: AC = $\left[\begin{array}{cc} 21 & 14 & 14 \\ 20 & 10 & 10 \\ 56 & 28 & 28 \end{array}\right]$, CA = $\left[\begin{array}{cc} 31 & 39 & 40 \\ 10 & 12 & 12 \\ 18 & 18 & 16 \end{array}\right]$
- (iii) AD and DA: AD = $\left[\begin{array}{cc} 20 & 32 \\ 17 & 19 \\ 43 & 45 \end{array}\right]$, DA is not defined because the number of columns of the first matrix does not match the number of rows of the second matrix.
- (iv) DC and CD and $D^TC$: DC is not defined because the number of columns of the first matrix does not match the number of rows of the second matrix. CD = $\left[\begin{array}{cc} 43 & 41 \\ 13 & 13 \\ 18 & 22 \end{array}\right]$, $D^TC = \left[\begin{array}{cc} 38 & 18 & 18 \\ 32 & 18 & 18 \end{array}\right]$
- (v) B$u$ and $u$B: B$u$ = $\left[\begin{array}{cc} 14 \\ 4 \end{array}\right]$, $u$B is not defined because the number of columns of the first matrix does not match the number of rows of the second matrix.
- (vi) A$u$: A$u$ is not defined because the number of columns of the first matrix does not match the number of rows of the second matrix.
- (vii) A$v$ and $v$A: A$v$ = $\left[\begin{array}{cc} 18 \\ 13 \\ 31 \end{array}\right]$, $v$A is not defined because the number of columns of the first matrix does not match the number of rows of the second matrix.
- (viii) A$v$ + C$v$: A$v$ + C$v$ = $\left[\begin{array}{cc} 18 \\ 13 \\ 31 \end{array}\right]$ + $\left[\begin{array}{cc} 29 \\ 9 \\ 14 \end{array}\right]$ = $\left[\begin{array}{cc} 47 \\ 22 \\ 45 \end{array}\right]$

#### Question (c)

Consider the following objects:

$$
A = \left[\begin{array}{cc} 1 & 3 & 4 \\ 2 & 2 & 1 \\ 6 & 4 & 3 \end{array}\right],
u = \left[\begin{array}{cc} 1 \\ 3 \end{array}\right],
v = \left[\begin{array}{cc} 2 \\ 4 \\ 1 \end{array}\right],
w = \left[\begin{array}{cc} 1 \\ -2 \\ 2 \end{array}\right]
$$

Compute the following:

- (i) $||u||_1 $ = $|1| + |3| = 4$, $||u||_2$ = $\sqrt{1^2 + 3^2} = \sqrt{10}$, $||u||_2^2$ = $1^2 + 3^2 = 10$, $||u||_{\infty}$ means the maximum absolute value of the elements in the vector, so $||u||_{\infty}$ = 3.
- (ii) $||v||_1 $ = $|2| + |4| + |1| = 7$, $||v||_2$ = $\sqrt{2^2 + 4^2 + 1^2} = \sqrt{21}$, $||v||_2^2$ = $2^2 + 4^2 + 1^2 = 21$, $||v||_{\infty}$ = 4.
- (iii) $ || v + w ||_1 $ = $|2 + 1| + |4 - 2| + |1 + 2| = 8$, $||v + w||_2$ = $\sqrt{3^2 + 2^2 + 3^2} = \sqrt{22}$, $||v + w||_2^2$ = $3^2 + 2^2 + 3^2 = 22$, $||v + w||_{\infty}$ = 3.
- (iv) $ ||Av||_1 $ = $|18| + |13| + |31| = 62$, $||Av||_2$ = $\sqrt{18^2 + 13^2 + 31^2} = \sqrt{1454}$, $||v - w||_{\infty}$ = 6

#### Question (d)

Consider the following vectors in $R^2$

$$ u = \left[\begin{array}{cc} 1 \\ 2 \end{array}\right], v = \left[\begin{array}{cc} 1 \\ 1 \end{array}\right], w = \left[\begin{array}{cc} -1 \\ 1/2 \end{array}\right] $$

Compute the dot products between all pairs of vectors. Note that the dot product may be written using the following equivalent forms:
$ <x, y> = x \cdot y = x^Ty $

Then compute the angle between the vectors and plot.

The dot products between all pairs of vectors are: $u * v = 1* 1 + 2* 1 = 3$, $u * w = 1* -1 + 2* 1/2 = 0$, $v * w = 1* -1 + 1* 1/2 = -1/2$.

The angle between the vectors can be calculated using the formula: $cos(\theta) = \frac{u \cdot v}{||u||_2||v||_2}$, $cos(\theta) = \frac{3}{\sqrt{5} \cdot \sqrt{2}} = \frac{3}{\sqrt{10}}$.

#### Question (e)

Dot products are extremely important in machine learning, explain what it means for a dot product to be zero, positive or negative.

- If the dot product of two vectors is zero, it means the two vectors are orthogonal to each other.
- If the dot product of two vectors is positive, it means the two vectors are pointing in the same direction.
- If the dot product of two vectors is negative, it means the two vectors are pointing in the opposite direction.

#### Question (f)

Consider the 2 x 2 matrix:
$$ A = \left[\begin{array}{cc} 1 & 3 \\ 4 & 1 \end{array}\right] $$

Compute the inverse of A = $\frac{1}{ad - bc} \left[\begin{array}{cc} d & -b \\ -c & a \end{array}\right] = \frac{1}{1\cdot 1 - 3\cdot 4} \left[\begin{array}{cc} 1 & -3 \\ -4 & 1 \end{array}\right] = \left[\begin{array}{cc} -1/11 & 3/11 \\ 4/11 & 1/11 \end{array}\right]$

#### Question (g)

Consider the 2 x 2 matrix:
$$ A = \left[\begin{array}{cc} 3 & 3 \\ 4 & 4 \end{array}\right] $$

Compute the inverse of $A^{-1}$ = $\frac{1}{ad - bc} \left[\begin{array}{cc} d & -b \\ -c & a \end{array}\right]$ = $\frac{1}{3\cdot 4 - 3\cdot 4} \left[\begin{array}{cc} 4 & -3 \\ -4 & 3 \end{array}\right]$, the inverse of A does not exist because the determinant of A is 0.

#### Question (h)

Let X be a matrix (of any dimension), show that $X^TX$ is always symmetric.

- Transposition is contravariant over multiplication, $(AB)^T = B^TA^T$, so $(X^TX)^T = X^T(X^T)^T = X^TX$.
